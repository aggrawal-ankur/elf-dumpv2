#include "mappings.h"
#define NULL ((void *)0)

struct Mapp d_ehtypes[] = {
  {0, "ET_NONE"},
  {1, "ET_REL"},
  {2, "ET_EXEC"},
  {3, "ET_DYN"},
  {4, "ET_CORE"},
  {5, "ET_NUM"},
  {0xff00, "ET_LOPROC"},
  {0xffff, "ET_HIPROC"},
  {-1, NULL},
};

struct Mapp d_class[] = {
  {0, "ELFCLASSNONE"},
  {1, "ELFCLASS32"},
  {2, "ELFCLASS64"},
};

struct Mapp ei_data[] = {
  {0, "ELFDATANONE"},
  {1, "ELFDATA2LSB"},
  {2, "ELFDATA2MSB"},
};

struct Mapp d_ehmachines[] = {
  {0, "ET_NONE"},
  {1, "EM_M32"},
  {2, "EM_SPARC"},
  {3, "EM_386"},
  {7, "EM_860"},
  {19, "EM_960"},
  {40, "EM_ARM"},
  {62, "EM_X86_64"},
  {183, "EM_AARCH64"},
  {243, "EM_RISCV"},
  {-1, NULL},
};

struct Mapp d_phtypes[] = {
  {0, "PT_NULL"},
  {1, "PT_LOAD"},
  {2, "PT_DYNAMIC"},
  {3, "PT_INTERP"},
  {4, "PT_NOTE"},
  {5, "PT_SHLIB"},
  {6, "PT_PHDR"},
  {7, "PT_TLS"},
  {8, "PT_NUM"},
  {0x60000000, "PT_LOOS"},
  {0x6474e550, "PT_GNU_EH_FRAME"},
  {0x6474e551, "PT_GNU_STACK"},
  {0x6474e552, "PT_GNU_RELRO"},
  {0x6474e553, "PT_GNU_PROPERTY"},
  {0x6474e554, "PT_GNU_SFRAME"},
  {0x6ffffffa, "PT_LOSUNW"},
  {0x6ffffffa, "PT_SUNWBSS"},
  {0x6ffffffb, "PT_SUNWSTACK"},
  {0x6fffffff, "PT_HISUNW"},
  {0x6fffffff, "PT_HIOS"},
  {0x70000000, "PT_LOPROC"},
  {0x7fffffff, "PT_HIPROC"},
  {-1, NULL},
};

struct Mapp d_phflags[] = {
  {(1 << 0), "PF_X "},
  {(1 << 1), "PF_W "},
  {(1 << 2), "PF_R "}
};

struct Mapp d_shtypes[] = {
  {0, "SHT_NULL"},
  {1, "SHT_PROGBITS"},
  {2, "SHT_SYMTAB"},
  {3, "SHT_STRTAB"},
  {4, "SHT_RELA"},
  {5, "SHT_HASH"},
  {6, "SHT_DYNAMIC"},
  {7, "SHT_NOTE"},
  {8, "SHT_NOBITS"},
  {9, "SHT_REL"},
  {10, "SHT_SHLIB"},
  {11, "SHT_DYNSYM"},
  {14, "SHT_INIT_ARRAY"},
  {15, "SHT_FINI_ARRAY"},
  {16, "SHT_PREINIT_ARRAY"},
  {17, "SHT_GROUP"},
  {18, "SHT_SYMTAB_SHNDX"},
  {19, "SHT_RELR"},
  {0x60000000, "SHT_LOOS"},
  {0x6ffffff5, "SHT_GNU_ATTRIBUTES"},
  {0x6ffffff6, "SHT_GNU_HASH"},
  {0x6ffffff7, "SHT_GNU_LIBLIST"},
  {0x6ffffff8, "SHT_CHECKSUM"},
  {0x6ffffffa, "SHT_LOSUNW"},
  {0x6ffffffa, "SHT_SUNW_move"},
  {0x6ffffffb, "SHT_SUNW_COMDAT"},
  {0x6ffffffc, "SHT_SUNW_syminfo"},
  {0x6ffffffd, "SHT_GNU_verdef"},
  {0x6ffffffe, "SHT_GNU_verneed"},
  {0x6fffffff, "SHT_GNU_versym"},
  {0x6fffffff, "SHT_HISUNW"},
  {0x6fffffff, "SHT_HIOS"},
  {0x70000000, "SHT_LOPROC"},
  {0x7fffffff, "SHT_HIPROC"},
  {0x80000000, "SHT_LOUSER"},
  {0x8fffffff, "SHT_HIUSER"},
  {-1, NULL},
};

struct Mapp d_shflags[] = {
  {(1 << 0), "SHF_WRITE"},
  {(1 << 1), "SHF_ALLOC"},
  {(1 << 2), "SHF_EXECINSTR"},
  {(1 << 4), "SHF_MERGE"},
  {(1 << 5), "SHF_STRINGS"},
  {(1 << 6), "SHF_INFO_LINK"},
  {(1 << 7), "SHF_LINK_ORDER"},
  {(1 << 8), "SHF_OS_NONCONFORMING"},
  {(1 << 9), "SHF_GROUP"},
  {(1 << 10), "SHF_TLS"},
  {(1 << 11), "SHF_COMPRESSED"},
  {0x0ff00000, "SHF_MASKOS"},
  {0xf0000000, "SHF_MASKPROC"},
  {(1 << 21), "SHF_GNU_RETAIN"},
  {(1 << 30), "SHF_ORDERED"},
  {(1U << 31), "SHF_EXCLUDE"},
  {-1, NULL}
};

struct Mapp d_sttypes[] = {
  {0, "STT_NOTYPE"},
  {1, "STT_OBJECT"},
  {2, "STT_FUNC"},
  {3, "STT_SECTION"},
  {4, "STT_FILE"},
  {5, "STT_COMMON"},
  {6, "STT_TLS"},
  {13, "LOPROC"},
  {15, "HIPROC"},
  {-1, NULL},
};

struct Mapp d_stbinds[] = {
  {0,  "STB_LOCAL"},
  {1,  "STB_GLOBAL"},
  {2,  "STB_WEAK"},
  {10, "STB_GNU_UNIQUE"},
  {13, "LOPROC"},
  {15, "HIPROC"},
  {-1, NULL},
};

struct Mapp d_stvisible[] = {
  {0, "STV_DEFAULT"},
  {1, "STV_INTERNAL"},
  {2, "STV_HIDDEN"},
  {3, "STV_PROTECTED"},
  {-1, NULL},
};

struct Mapp rtypes[] = {
  {0, "R_X86_64_NONE"},
  {1, "R_X86_64_64"},
  {2, "R_X86_64_PC32"},
  {3, "R_X86_64_GOT32"},
  {4, "R_X86_64_PLT32"},
  {5, "R_X86_64_COPY"},
  {6, "R_X86_64_GLOB_DAT"},
  {7, "R_X86_64_JUMP_SLOT"},
  {8, "R_X86_64_RELATIVE"},
  {9, "R_X86_64_GOTPCREL"},
  {10, "R_X86_64_32"},
  {11, "R_X86_64_32S"},
  {12, "R_X86_64_16"},
  {13, "R_X86_64_PC16"},
  {14, "R_X86_64_8"},
  {15, "R_X86_64_PC8"},
  {16, "R_X86_64_DTPMOD64"},
  {17, "R_X86_64_DTPOFF64"},
  {18, "R_X86_64_TPOFF64"},
  {19, "R_X86_64_TLSGD"},
  {20, "R_X86_64_TLSLD"},
  {21, "R_X86_64_DTPOFF32"},
  {22, "R_X86_64_GOTTPOFF"},
  {23, "R_X86_64_TPOFF32"},
  {24, "R_X86_64_PC64"},
  {25, "R_X86_64_GOTOFF64"},
  {26, "R_X86_64_GOTPC32"},
  {27, "R_X86_64_GOT64"},
  {28, "R_X86_64_GOTPCREL64"},
  {29, "R_X86_64_GOTPC64"},
  {30, "R_X86_64_GOTPLT64"},
  {31, "R_X86_64_PLTOFF64"},
  {32, "R_X86_64_SIZE32"},
  {33, "R_X86_64_SIZE64"},
  {34, "R_X86_64_GOTPC32_TLSDESC"},
  {35, "R_X86_64_TLSDESC_CALL"},
  {36, "R_X86_64_TLSDESC"},
  {37, "R_X86_64_IRELATIVE"},
  {38, "R_X86_64_RELATIVE64"},
  {41, "R_X86_64_GOTPCRELX"},
  {42, "R_X86_64_REX_GOTPCRELX"},
  {43, "R_X86_64_NUM"},
  {-1, NULL},
};

struct DTypes d_dtypes[] = {
  {0, "DT_NULL", "ignored", "Marks the end of the .dynamic array"},
  {1, "DT_NEEDED", "d_un.d_val", "OFFSET in .strtab resolving to the name of a shared library"},
  {2, "DT_PLTRELSZ", "d_un.d_val", "The size of .rela.plt entries (in bytes)"},
  {3, "DT_PLTGOT", "d_un.d_ptr", "The address of .plt.got section"},
  {4, "DT_HASH", "d_un.d_ptr", "The address of the HASH table "},
  {5, "DT_STRTAB", "d_un.d_ptr", "The address of the .strtab"},
  {6, "DT_SYMTAB", "d_un.d_ptr", "The address of the .symtab"},
  {7, "DT_RELA", "d_un.d_ptr", "The address of the .rela.dyn entries"},
  {8, "DT_RELASZ", "d_un.d_val", "The size of .rela.dyn entries (in bytes)"},
  {9, "DT_RELAENT", "d_un.d_val", "The size of a single .rela.dyn entry (in bytes)"},
  {10, "DT_STRSZ", "d_un.d_val", "The size of the .strtab (in bytes)"},
  {11, "DT_SYMENT", "d_un.d_val", "The size of a single .symtab entry (in bytes)"},
  {12, "DT_INIT", "d_un.d_ptr", "The address of the INIT()"},
  {13, "DT_FINI", "d_un.d_ptr", "The address of the FINI()"},
  {14, "DT_SONAME", "d_un.d_val", "NEEDS TO BE WRITTEN"},
  {15, "DT_RPATH", "d_un.d_val", "OFFSET in .strtab for a path to search for shared libraries"},
  {16, "DT_SYMBOLIC", "ignored", "NEEDS TO BE WRITTEN"},
  {17, "DT_REL", "d_un.d_ptr", "The address of the .rel.dyn entries"},
  {18, "DT_RELSZ", "d_un.d_val", "The size of .rel.dyn entries (in bytes)"},
  {19, "DT_RELENT", "d_un.d_val", "The size of a single .rel.dyn entry (in bytes)"},
  {20, "DT_PLTREL", "d_un.d_val", "Tells whether addends are used in .rela.plt relocations or not; stores DT_REL/DT_RELA"},
  {21, "DT_DEBUG", "d_un.d_ptr", "Used in debugging"},
  {22, "DT_TEXTREL", "ignored", "NEEDS TO BE WRITTEN"},
  {23, "DT_JMPREL", "d_un.d_ptr", "The address of .rela.plt entries"},
  {24, "DT_BIND_NOW", "ignored", "NEEDS TO BE WRITTEN"},
  {25, "DT_INIT_ARRAY", ""},
  {26, "DT_FINI_ARRAY", ""},
  {27, "DT_INIT_ARRAYSZ", ""},
  {28, "DT_FINI_ARRAYSZ", ""},
  {29, "DT_RUNPATH", ""},
  {30, "DT_FLAGS", ""},
  {32, "DT_ENCODING", ""},
  {32, "DT_PREINIT_ARRAY", ""},
  {33, "DT_PREINIT_ARRAYSZ", ""},
  {34, "DT_SYMTAB_SHNDX", ""},
  {35, "DT_RELRSZ", ""},
  {36, "DT_RELR", ""},
  {37, "DT_RELRENT", ""},
  {0x6ffffff0, "DT_VERSYM", ""},
  {0x6ffffff9, "DT_RELACOUNT", ""},
  {0x6ffffffa, "DT_RELCOUNT", ""},
  {0x6ffffffb, "DT_FLAGS_1", ""},
  {0x6ffffffc, "DT_VERDEF", ""},
  {0x6ffffffd, "DT_VERDEFNUM", ""},
  {0x6ffffffe, "DT_VERNEED", ""},
  {0x6fffffff, "DT_VERNEEDNUM", ""},
  {0x6ffffef5, "DT_GNU_HASH", ""},
  {0x70000000, "LOPROC", "unspecified"},
  {0x7fffffff, "HIPROC", "unspecified"},
  {-1, NULL, NULL}
};

struct DTypes *find_tag(uint64_t v){
  struct DTypes* tags = d_dtypes;
  for (; tags->macro != NULL; tags++){
    if (tags->value == v) return tags;
  }
  return NULL;
}